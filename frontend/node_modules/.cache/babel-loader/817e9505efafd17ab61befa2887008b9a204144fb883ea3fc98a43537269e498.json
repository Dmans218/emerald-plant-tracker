{"ast":null,"code":"import Tesseract from 'tesseract.js';\n\n// Parse environmental data from Spider Farmer app screenshot\nexport const parseSpiderFarmerScreenshot = async imageFile => {\n  try {\n    const {\n      data: {\n        text\n      }\n    } = await Tesseract.recognize(imageFile, 'eng', {\n      logger: m => console.log(m),\n      tessedit_char_whitelist: '0123456789.°C%kPa ppm μmol/s-+:VPDCOTemperatureHumidityAir '\n    });\n    console.log('OCR Raw Text:', text);\n\n    // Initialize result object\n    const result = {\n      temperature: null,\n      humidity: null,\n      ph: null,\n      co2: null,\n      vpd: null,\n      ppfd: null,\n      success: false,\n      parsedValues: {}\n    };\n\n    // Clean text for better analysis\n    const cleanText = text.replace(/\\s+/g, ' ').trim();\n    const lines = text.split('\\n').map(line => line.trim()).filter(line => line.length > 0);\n    console.log('Text lines:', lines);\n\n    // Extract all numbers with context for smarter parsing\n    const numberPattern = /(\\d+\\.?\\d*)/g;\n    const allNumbers = [];\n    let match;\n    while ((match = numberPattern.exec(text)) !== null) {\n      const number = parseFloat(match[1]);\n      const index = match.index;\n      const contextBefore = text.substring(Math.max(0, index - 20), index).toLowerCase();\n      const contextAfter = text.substring(index, Math.min(text.length, index + 20)).toLowerCase();\n      allNumbers.push({\n        value: number,\n        text: match[1],\n        index: index,\n        contextBefore: contextBefore,\n        contextAfter: contextAfter,\n        fullContext: contextBefore + match[1] + contextAfter\n      });\n    }\n    console.log('Numbers with context:', allNumbers);\n\n    // Parse Temperature - look for temperature in proper range with °C\n    for (const num of allNumbers) {\n      if (!result.temperature && num.value >= 15 && num.value <= 40) {\n        const context = num.fullContext;\n        // Check if it's near temperature indicators and has degree symbol\n        if ((context.includes('temp') || context.includes('air')) && (context.includes('°') || context.includes('º')) && !context.includes('vpd') && !context.includes('%')) {\n          result.temperature = num.value;\n          result.parsedValues.temperature = `${num.value}°C`;\n          console.log('Found temperature:', num.value, 'Context:', context);\n          break;\n        }\n      }\n    }\n\n    // Parse Humidity - look for percentage values in humidity range\n    for (const num of allNumbers) {\n      if (!result.humidity && num.value >= 20 && num.value <= 100) {\n        const context = num.fullContext;\n        // Check if it's clearly marked as percentage or near humidity keywords\n        if (context.includes('%') || context.includes('humid') && !context.includes('°') && !context.includes('vpd')) {\n          result.humidity = num.value;\n          result.parsedValues.humidity = `${num.value}%`;\n          console.log('Found humidity:', num.value, 'Context:', context);\n          break;\n        }\n      }\n    }\n\n    // Parse VPD - look for small decimal values with kPa context  \n    for (const num of allNumbers) {\n      if (!result.vpd && num.value >= 0.1 && num.value <= 5.0) {\n        const context = num.fullContext;\n        // VPD should be small decimal near \"VPD\" text or \"kPa\"\n        if (context.includes('vpd') || context.includes('kpa') && num.value < 10 || num.value < 2.0 && context.includes('kpa')) {\n          result.vpd = num.value;\n          result.parsedValues.vpd = `${num.value} kPa`;\n          console.log('Found VPD:', num.value, 'Context:', context);\n          break;\n        }\n      }\n    }\n\n    // Fallback parsing if direct context matching fails\n    if (!result.temperature || !result.humidity || !result.vpd) {\n      console.log('Using fallback parsing...');\n\n      // Sort numbers by value to help identify them\n      const sortedNumbers = [...allNumbers].sort((a, b) => a.value - b.value);\n      console.log('Sorted numbers:', sortedNumbers.map(n => n.value));\n\n      // If we don't have temperature, look for number around 20-25 (room temp)\n      if (!result.temperature) {\n        const tempCandidate = sortedNumbers.find(n => n.value >= 18 && n.value <= 30);\n        if (tempCandidate && !tempCandidate.fullContext.includes('%')) {\n          result.temperature = tempCandidate.value;\n          result.parsedValues.temperature = `${tempCandidate.value}°C`;\n          console.log('Fallback temperature:', tempCandidate.value);\n        }\n      }\n\n      // If we don't have humidity, look for larger numbers with %\n      if (!result.humidity) {\n        const humidCandidate = sortedNumbers.find(n => n.value >= 40 && n.value <= 95 && (n.fullContext.includes('%') || n.value > 50));\n        if (humidCandidate) {\n          result.humidity = humidCandidate.value;\n          result.parsedValues.humidity = `${humidCandidate.value}%`;\n          console.log('Fallback humidity:', humidCandidate.value);\n        }\n      }\n\n      // If we don't have VPD, look for small decimals\n      if (!result.vpd) {\n        const vpdCandidate = sortedNumbers.find(n => n.value >= 0.1 && n.value <= 2.0 && n.text.includes('.'));\n        if (vpdCandidate) {\n          result.vpd = vpdCandidate.value;\n          result.parsedValues.vpd = `${vpdCandidate.value} kPa`;\n          console.log('Fallback VPD:', vpdCandidate.value);\n        }\n      }\n    }\n\n    // Parse CO2 (ppm pattern)\n    let co2Match = text.match(/co\\s*[₂2]?\\s*[:\\-]?\\s*(\\d+)/i) || text.match(/(\\d+)\\s*ppm/i);\n\n    // Look for numbers in CO2 range\n    if (!co2Match && allNumbers.length > 0) {\n      for (const num of allNumbers) {\n        const val = parseFloat(num);\n        if (val >= 300 && val <= 2000) {\n          // Typical CO2 range\n          const numIndex = text.indexOf(num);\n          const surrounding = text.substring(Math.max(0, numIndex - 15), numIndex + 15).toLowerCase();\n          if (surrounding.includes('co2') || surrounding.includes('ppm')) {\n            co2Match = [null, num];\n            break;\n          }\n        }\n      }\n    }\n    if (co2Match) {\n      result.co2 = parseFloat(co2Match[1]);\n      result.parsedValues.co2 = `${co2Match[1]} ppm`;\n    }\n\n    // Parse PPFD (μmol pattern)\n    let ppfdMatch = text.match(/ppfd\\s*[:\\-]?\\s*(\\d+)/i) || text.match(/(\\d+)\\s*[μu]mol/i);\n\n    // Look for numbers in PPFD range\n    if (!ppfdMatch && allNumbers.length > 0) {\n      for (const num of allNumbers) {\n        const val = parseFloat(num);\n        if (val >= 100 && val <= 2000) {\n          // Typical PPFD range\n          const numIndex = text.indexOf(num);\n          const surrounding = text.substring(Math.max(0, numIndex - 15), numIndex + 15).toLowerCase();\n          if (surrounding.includes('ppfd') || surrounding.includes('μmol') || surrounding.includes('umol')) {\n            ppfdMatch = [null, num];\n            break;\n          }\n        }\n      }\n    }\n    if (ppfdMatch) {\n      result.ppfd = parseFloat(ppfdMatch[1]);\n      result.parsedValues.ppfd = `${ppfdMatch[1]} μmol/m²/s`;\n    }\n\n    // Parse pH\n    let phMatch = text.match(/ph\\s*[:\\-]?\\s*(\\d+\\.?\\d*)/i);\n    if (!phMatch && allNumbers.length > 0) {\n      for (const num of allNumbers) {\n        const val = parseFloat(num);\n        if (val >= 4.0 && val <= 9.0) {\n          // Typical pH range\n          const numIndex = text.indexOf(num);\n          const surrounding = text.substring(Math.max(0, numIndex - 10), numIndex + 10).toLowerCase();\n          if (surrounding.includes('ph')) {\n            phMatch = [null, num];\n            break;\n          }\n        }\n      }\n    }\n    if (phMatch) {\n      result.ph = parseFloat(phMatch[1]);\n      result.parsedValues.ph = phMatch[1];\n    }\n\n    // Check if we found at least one value\n    result.success = Object.values(result).some(val => val !== null && typeof val === 'number');\n    console.log('Parsed result:', result);\n    return result;\n  } catch (error) {\n    console.error('OCR Error:', error);\n    return {\n      temperature: null,\n      humidity: null,\n      ph: null,\n      co2: null,\n      vpd: null,\n      ppfd: null,\n      success: false,\n      error: error.message,\n      parsedValues: {}\n    };\n  }\n};\n\n// Helper function to preprocess image for better OCR\nexport const preprocessImageForOCR = (canvas, context) => {\n  const imageData = context.getImageData(0, 0, canvas.width, canvas.height);\n  const data = imageData.data;\n\n  // Convert to grayscale and increase contrast\n  for (let i = 0; i < data.length; i += 4) {\n    const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;\n\n    // Increase contrast (simple threshold)\n    const contrast = gray > 128 ? 255 : 0;\n    data[i] = contrast; // Red\n    data[i + 1] = contrast; // Green\n    data[i + 2] = contrast; // Blue\n  }\n  context.putImageData(imageData, 0, 0);\n  return canvas.toDataURL();\n};\n\n// Parse different app layouts/formats\nexport const parseEnvironmentalData = async imageFile => {\n  // Try Spider Farmer format first\n  const spiderFarmerResult = await parseSpiderFarmerScreenshot(imageFile);\n  if (spiderFarmerResult.success) {\n    return {\n      ...spiderFarmerResult,\n      source: 'Spider Farmer App'\n    };\n  }\n\n  // Could add other app parsers here in the future\n  return {\n    ...spiderFarmerResult,\n    source: 'Unknown',\n    message: 'Could not parse environmental data from image. Please ensure the image shows clear readings from a supported app.'\n  };\n};","map":{"version":3,"names":["Tesseract","parseSpiderFarmerScreenshot","imageFile","data","text","recognize","logger","m","console","log","tessedit_char_whitelist","result","temperature","humidity","ph","co2","vpd","ppfd","success","parsedValues","cleanText","replace","trim","lines","split","map","line","filter","length","numberPattern","allNumbers","match","exec","number","parseFloat","index","contextBefore","substring","Math","max","toLowerCase","contextAfter","min","push","value","fullContext","num","context","includes","sortedNumbers","sort","a","b","n","tempCandidate","find","humidCandidate","vpdCandidate","co2Match","val","numIndex","indexOf","surrounding","ppfdMatch","phMatch","Object","values","some","error","message","preprocessImageForOCR","canvas","imageData","getImageData","width","height","i","gray","contrast","putImageData","toDataURL","parseEnvironmentalData","spiderFarmerResult","source"],"sources":["/home/dmans218/projects/Growlogger/frontend/src/utils/ocrParser.js"],"sourcesContent":["import Tesseract from 'tesseract.js';\n\n// Parse environmental data from Spider Farmer app screenshot\nexport const parseSpiderFarmerScreenshot = async (imageFile) => {\n  try {\n    const { data: { text } } = await Tesseract.recognize(imageFile, 'eng', {\n      logger: m => console.log(m),\n      tessedit_char_whitelist: '0123456789.°C%kPa ppm μmol/s-+:VPDCOTemperatureHumidityAir ',\n    });\n\n    console.log('OCR Raw Text:', text);\n\n    // Initialize result object\n    const result = {\n      temperature: null,\n      humidity: null,\n      ph: null,\n      co2: null,\n      vpd: null,\n      ppfd: null,\n      success: false,\n      parsedValues: {}\n    };\n\n    // Clean text for better analysis\n    const cleanText = text.replace(/\\s+/g, ' ').trim();\n    const lines = text.split('\\n').map(line => line.trim()).filter(line => line.length > 0);\n    console.log('Text lines:', lines);\n\n    // Extract all numbers with context for smarter parsing\n    const numberPattern = /(\\d+\\.?\\d*)/g;\n    const allNumbers = [];\n    let match;\n    while ((match = numberPattern.exec(text)) !== null) {\n      const number = parseFloat(match[1]);\n      const index = match.index;\n      const contextBefore = text.substring(Math.max(0, index - 20), index).toLowerCase();\n      const contextAfter = text.substring(index, Math.min(text.length, index + 20)).toLowerCase();\n      allNumbers.push({\n        value: number,\n        text: match[1],\n        index: index,\n        contextBefore: contextBefore,\n        contextAfter: contextAfter,\n        fullContext: contextBefore + match[1] + contextAfter\n      });\n    }\n    \n    console.log('Numbers with context:', allNumbers);\n\n    // Parse Temperature - look for temperature in proper range with °C\n    for (const num of allNumbers) {\n      if (!result.temperature && num.value >= 15 && num.value <= 40) {\n        const context = num.fullContext;\n        // Check if it's near temperature indicators and has degree symbol\n        if ((context.includes('temp') || context.includes('air')) && \n            (context.includes('°') || context.includes('º')) &&\n            !context.includes('vpd') && !context.includes('%')) {\n          result.temperature = num.value;\n          result.parsedValues.temperature = `${num.value}°C`;\n          console.log('Found temperature:', num.value, 'Context:', context);\n          break;\n        }\n      }\n    }\n\n    // Parse Humidity - look for percentage values in humidity range\n    for (const num of allNumbers) {\n      if (!result.humidity && num.value >= 20 && num.value <= 100) {\n        const context = num.fullContext;\n        // Check if it's clearly marked as percentage or near humidity keywords\n        if (context.includes('%') || \n            (context.includes('humid') && !context.includes('°') && !context.includes('vpd'))) {\n          result.humidity = num.value;\n          result.parsedValues.humidity = `${num.value}%`;\n          console.log('Found humidity:', num.value, 'Context:', context);\n          break;\n        }\n      }\n    }\n\n    // Parse VPD - look for small decimal values with kPa context  \n    for (const num of allNumbers) {\n      if (!result.vpd && num.value >= 0.1 && num.value <= 5.0) {\n        const context = num.fullContext;\n        // VPD should be small decimal near \"VPD\" text or \"kPa\"\n        if (context.includes('vpd') || \n            (context.includes('kpa') && num.value < 10) ||\n            (num.value < 2.0 && context.includes('kpa'))) {\n          result.vpd = num.value;\n          result.parsedValues.vpd = `${num.value} kPa`;\n          console.log('Found VPD:', num.value, 'Context:', context);\n          break;\n        }\n      }\n    }\n\n    // Fallback parsing if direct context matching fails\n    if (!result.temperature || !result.humidity || !result.vpd) {\n      console.log('Using fallback parsing...');\n      \n      // Sort numbers by value to help identify them\n      const sortedNumbers = [...allNumbers].sort((a, b) => a.value - b.value);\n      console.log('Sorted numbers:', sortedNumbers.map(n => n.value));\n      \n      // If we don't have temperature, look for number around 20-25 (room temp)\n      if (!result.temperature) {\n        const tempCandidate = sortedNumbers.find(n => n.value >= 18 && n.value <= 30);\n        if (tempCandidate && !tempCandidate.fullContext.includes('%')) {\n          result.temperature = tempCandidate.value;\n          result.parsedValues.temperature = `${tempCandidate.value}°C`;\n          console.log('Fallback temperature:', tempCandidate.value);\n        }\n      }\n      \n      // If we don't have humidity, look for larger numbers with %\n      if (!result.humidity) {\n        const humidCandidate = sortedNumbers.find(n => \n          n.value >= 40 && n.value <= 95 && \n          (n.fullContext.includes('%') || n.value > 50)\n        );\n        if (humidCandidate) {\n          result.humidity = humidCandidate.value;\n          result.parsedValues.humidity = `${humidCandidate.value}%`;\n          console.log('Fallback humidity:', humidCandidate.value);\n        }\n      }\n      \n      // If we don't have VPD, look for small decimals\n      if (!result.vpd) {\n        const vpdCandidate = sortedNumbers.find(n => \n          n.value >= 0.1 && n.value <= 2.0 && \n          n.text.includes('.')\n        );\n        if (vpdCandidate) {\n          result.vpd = vpdCandidate.value;\n          result.parsedValues.vpd = `${vpdCandidate.value} kPa`;\n          console.log('Fallback VPD:', vpdCandidate.value);\n        }\n      }\n    }\n\n        // Parse CO2 (ppm pattern)\n    let co2Match = text.match(/co\\s*[₂2]?\\s*[:\\-]?\\s*(\\d+)/i) || \n                     text.match(/(\\d+)\\s*ppm/i);\n    \n    // Look for numbers in CO2 range\n    if (!co2Match && allNumbers.length > 0) {\n      for (const num of allNumbers) {\n        const val = parseFloat(num);\n        if (val >= 300 && val <= 2000) { // Typical CO2 range\n          const numIndex = text.indexOf(num);\n          const surrounding = text.substring(Math.max(0, numIndex - 15), numIndex + 15).toLowerCase();\n          if (surrounding.includes('co2') || surrounding.includes('ppm')) {\n            co2Match = [null, num];\n            break;\n          }\n        }\n      }\n    }\n    \n    if (co2Match) {\n      result.co2 = parseFloat(co2Match[1]);\n      result.parsedValues.co2 = `${co2Match[1]} ppm`;\n    }\n\n        // Parse PPFD (μmol pattern)\n    let ppfdMatch = text.match(/ppfd\\s*[:\\-]?\\s*(\\d+)/i) ||\n                      text.match(/(\\d+)\\s*[μu]mol/i);\n    \n    // Look for numbers in PPFD range\n    if (!ppfdMatch && allNumbers.length > 0) {\n      for (const num of allNumbers) {\n        const val = parseFloat(num);\n        if (val >= 100 && val <= 2000) { // Typical PPFD range\n          const numIndex = text.indexOf(num);\n          const surrounding = text.substring(Math.max(0, numIndex - 15), numIndex + 15).toLowerCase();\n          if (surrounding.includes('ppfd') || surrounding.includes('μmol') || surrounding.includes('umol')) {\n            ppfdMatch = [null, num];\n            break;\n          }\n        }\n      }\n    }\n    \n    if (ppfdMatch) {\n      result.ppfd = parseFloat(ppfdMatch[1]);\n      result.parsedValues.ppfd = `${ppfdMatch[1]} μmol/m²/s`;\n    }\n\n    // Parse pH\n    let phMatch = text.match(/ph\\s*[:\\-]?\\s*(\\d+\\.?\\d*)/i);\n    if (!phMatch && allNumbers.length > 0) {\n      for (const num of allNumbers) {\n        const val = parseFloat(num);\n        if (val >= 4.0 && val <= 9.0) { // Typical pH range\n          const numIndex = text.indexOf(num);\n          const surrounding = text.substring(Math.max(0, numIndex - 10), numIndex + 10).toLowerCase();\n          if (surrounding.includes('ph')) {\n            phMatch = [null, num];\n            break;\n          }\n        }\n      }\n    }\n    \n    if (phMatch) {\n      result.ph = parseFloat(phMatch[1]);\n      result.parsedValues.ph = phMatch[1];\n    }\n\n    // Check if we found at least one value\n    result.success = Object.values(result).some(val => val !== null && typeof val === 'number');\n\n    console.log('Parsed result:', result);\n    return result;\n  } catch (error) {\n    console.error('OCR Error:', error);\n    return {\n      temperature: null,\n      humidity: null,\n      ph: null,\n      co2: null,\n      vpd: null,\n      ppfd: null,\n      success: false,\n      error: error.message,\n      parsedValues: {}\n    };\n  }\n};\n\n// Helper function to preprocess image for better OCR\nexport const preprocessImageForOCR = (canvas, context) => {\n  const imageData = context.getImageData(0, 0, canvas.width, canvas.height);\n  const data = imageData.data;\n\n  // Convert to grayscale and increase contrast\n  for (let i = 0; i < data.length; i += 4) {\n    const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;\n    \n    // Increase contrast (simple threshold)\n    const contrast = gray > 128 ? 255 : 0;\n    \n    data[i] = contrast;     // Red\n    data[i + 1] = contrast; // Green\n    data[i + 2] = contrast; // Blue\n  }\n\n  context.putImageData(imageData, 0, 0);\n  return canvas.toDataURL();\n};\n\n// Parse different app layouts/formats\nexport const parseEnvironmentalData = async (imageFile) => {\n  // Try Spider Farmer format first\n  const spiderFarmerResult = await parseSpiderFarmerScreenshot(imageFile);\n  \n  if (spiderFarmerResult.success) {\n    return {\n      ...spiderFarmerResult,\n      source: 'Spider Farmer App'\n    };\n  }\n\n  // Could add other app parsers here in the future\n  return {\n    ...spiderFarmerResult,\n    source: 'Unknown',\n    message: 'Could not parse environmental data from image. Please ensure the image shows clear readings from a supported app.'\n  };\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}