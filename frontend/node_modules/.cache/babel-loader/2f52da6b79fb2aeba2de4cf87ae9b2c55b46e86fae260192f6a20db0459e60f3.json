{"ast":null,"code":"import Tesseract from 'tesseract.js';\n\n// Parse environmental data from Spider Farmer app screenshot\nexport const parseSpiderFarmerScreenshot = async imageFile => {\n  try {\n    const {\n      data: {\n        text\n      }\n    } = await Tesseract.recognize(imageFile, 'eng', {\n      logger: m => console.log(m),\n      tessedit_char_whitelist: '0123456789.°C%kPa ppm μmol/s-+:VPDCOTemperatureHumidityAir '\n    });\n    console.log('OCR Raw Text:', text);\n\n    // Initialize result object\n    const result = {\n      temperature: null,\n      humidity: null,\n      ph: null,\n      co2: null,\n      vpd: null,\n      ppfd: null,\n      success: false,\n      parsedValues: {}\n    };\n\n    // Clean text for better analysis\n    const lines = text.split('\\n').map(line => line.trim()).filter(line => line.length > 0);\n    console.log('Text lines:', lines);\n\n    // Extract all numbers with context for smarter parsing\n    const numberPattern = /(\\d+\\.?\\d*)/g;\n    const allNumbers = [];\n    let match;\n    while ((match = numberPattern.exec(text)) !== null) {\n      const number = parseFloat(match[1]);\n      const index = match.index;\n      const contextBefore = text.substring(Math.max(0, index - 20), index).toLowerCase();\n      const contextAfter = text.substring(index, Math.min(text.length, index + 20)).toLowerCase();\n      allNumbers.push({\n        value: number,\n        text: match[1],\n        index: index,\n        contextBefore: contextBefore,\n        contextAfter: contextAfter,\n        fullContext: contextBefore + match[1] + contextAfter\n      });\n    }\n    console.log('Numbers with context:', allNumbers);\n\n    // Parse Temperature - look for temperature in proper range with °C\n    for (const num of allNumbers) {\n      if (!result.temperature && num.value >= 15 && num.value <= 40) {\n        const context = num.fullContext;\n        // Check if it's near temperature indicators and has degree symbol\n        if ((context.includes('temp') || context.includes('air')) && (context.includes('°') || context.includes('º')) && !context.includes('vpd') && !context.includes('%')) {\n          result.temperature = num.value;\n          result.parsedValues.temperature = `${num.value}°C`;\n          console.log('Found temperature:', num.value, 'Context:', context);\n          break;\n        }\n      }\n    }\n\n    // Parse Humidity - look for percentage values in humidity range\n    for (const num of allNumbers) {\n      if (!result.humidity && num.value >= 20 && num.value <= 100) {\n        const context = num.fullContext;\n        // Check if it's clearly marked as percentage or near humidity keywords\n        if (context.includes('%') || context.includes('humid') && !context.includes('°') && !context.includes('vpd')) {\n          result.humidity = num.value;\n          result.parsedValues.humidity = `${num.value}%`;\n          console.log('Found humidity:', num.value, 'Context:', context);\n          break;\n        }\n      }\n    }\n\n    // Parse VPD - look for small decimal values with kPa context  \n    for (const num of allNumbers) {\n      if (!result.vpd && num.value >= 0.1 && num.value <= 5.0) {\n        const context = num.fullContext;\n        // VPD should be small decimal near \"VPD\" text or \"kPa\"\n        if (context.includes('vpd') || context.includes('kpa') && num.value < 10 || num.value < 2.0 && context.includes('kpa')) {\n          result.vpd = num.value;\n          result.parsedValues.vpd = `${num.value} kPa`;\n          console.log('Found VPD:', num.value, 'Context:', context);\n          break;\n        }\n      }\n    }\n\n    // Fallback parsing if direct context matching fails\n    if (!result.temperature || !result.humidity || !result.vpd) {\n      console.log('Using fallback parsing...');\n\n      // Sort numbers by value to help identify them\n      const sortedNumbers = [...allNumbers].sort((a, b) => a.value - b.value);\n      console.log('Sorted numbers:', sortedNumbers.map(n => n.value));\n\n      // If we don't have temperature, look for number around 20-25 (room temp)\n      if (!result.temperature) {\n        const tempCandidate = sortedNumbers.find(n => n.value >= 18 && n.value <= 30);\n        if (tempCandidate && !tempCandidate.fullContext.includes('%')) {\n          result.temperature = tempCandidate.value;\n          result.parsedValues.temperature = `${tempCandidate.value}°C`;\n          console.log('Fallback temperature:', tempCandidate.value);\n        }\n      }\n\n      // If we don't have humidity, look for larger numbers with %\n      if (!result.humidity) {\n        const humidCandidate = sortedNumbers.find(n => n.value >= 40 && n.value <= 95 && (n.fullContext.includes('%') || n.value > 50));\n        if (humidCandidate) {\n          result.humidity = humidCandidate.value;\n          result.parsedValues.humidity = `${humidCandidate.value}%`;\n          console.log('Fallback humidity:', humidCandidate.value);\n        }\n      }\n\n      // If we don't have VPD, look for small decimals\n      if (!result.vpd) {\n        const vpdCandidate = sortedNumbers.find(n => n.value >= 0.1 && n.value <= 2.0 && n.text.includes('.'));\n        if (vpdCandidate) {\n          result.vpd = vpdCandidate.value;\n          result.parsedValues.vpd = `${vpdCandidate.value} kPa`;\n          console.log('Fallback VPD:', vpdCandidate.value);\n        }\n      }\n    }\n\n    // Parse CO2 (ppm pattern)\n    let co2Match = text.match(/co\\s*[₂2]?\\s*[:-]?\\s*(\\d+)/i) || text.match(/(\\d+)\\s*ppm/i);\n\n    // Look for numbers in CO2 range\n    if (!co2Match && allNumbers.length > 0) {\n      for (const num of allNumbers) {\n        const val = parseFloat(num);\n        if (val >= 300 && val <= 2000) {\n          // Typical CO2 range\n          const numIndex = text.indexOf(num);\n          const surrounding = text.substring(Math.max(0, numIndex - 15), numIndex + 15).toLowerCase();\n          if (surrounding.includes('co2') || surrounding.includes('ppm')) {\n            co2Match = [null, num];\n            break;\n          }\n        }\n      }\n    }\n    if (co2Match) {\n      result.co2 = parseFloat(co2Match[1]);\n      result.parsedValues.co2 = `${co2Match[1]} ppm`;\n    }\n\n    // Parse PPFD (μmol pattern)\n    let ppfdMatch = text.match(/ppfd\\s*[:-]?\\s*(\\d+)/i) || text.match(/(\\d+)\\s*[μu]mol/i);\n\n    // Look for numbers in PPFD range\n    if (!ppfdMatch && allNumbers.length > 0) {\n      for (const num of allNumbers) {\n        const val = parseFloat(num);\n        if (val >= 100 && val <= 2000) {\n          // Typical PPFD range\n          const numIndex = text.indexOf(num);\n          const surrounding = text.substring(Math.max(0, numIndex - 15), numIndex + 15).toLowerCase();\n          if (surrounding.includes('ppfd') || surrounding.includes('μmol') || surrounding.includes('umol')) {\n            ppfdMatch = [null, num];\n            break;\n          }\n        }\n      }\n    }\n    if (ppfdMatch) {\n      result.ppfd = parseFloat(ppfdMatch[1]);\n      result.parsedValues.ppfd = `${ppfdMatch[1]} μmol/m²/s`;\n    }\n\n    // Parse pH\n    let phMatch = text.match(/ph\\s*[:\\-]?\\s*(\\d+\\.?\\d*)/i);\n    if (!phMatch && allNumbers.length > 0) {\n      for (const num of allNumbers) {\n        const val = parseFloat(num);\n        if (val >= 4.0 && val <= 9.0) {\n          // Typical pH range\n          const numIndex = text.indexOf(num);\n          const surrounding = text.substring(Math.max(0, numIndex - 10), numIndex + 10).toLowerCase();\n          if (surrounding.includes('ph')) {\n            phMatch = [null, num];\n            break;\n          }\n        }\n      }\n    }\n    if (phMatch) {\n      result.ph = parseFloat(phMatch[1]);\n      result.parsedValues.ph = phMatch[1];\n    }\n\n    // Check if we found at least one value\n    result.success = Object.values(result).some(val => val !== null && typeof val === 'number');\n    console.log('Parsed result:', result);\n    return result;\n  } catch (error) {\n    console.error('OCR Error:', error);\n    return {\n      temperature: null,\n      humidity: null,\n      ph: null,\n      co2: null,\n      vpd: null,\n      ppfd: null,\n      success: false,\n      error: error.message,\n      parsedValues: {}\n    };\n  }\n};\n\n// Helper function to preprocess image for better OCR\nexport const preprocessImageForOCR = (canvas, context) => {\n  const imageData = context.getImageData(0, 0, canvas.width, canvas.height);\n  const data = imageData.data;\n\n  // Convert to grayscale and increase contrast\n  for (let i = 0; i < data.length; i += 4) {\n    const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;\n\n    // Increase contrast (simple threshold)\n    const contrast = gray > 128 ? 255 : 0;\n    data[i] = contrast; // Red\n    data[i + 1] = contrast; // Green\n    data[i + 2] = contrast; // Blue\n  }\n  context.putImageData(imageData, 0, 0);\n  return canvas.toDataURL();\n};\n\n// Parse different app layouts/formats\nexport const parseEnvironmentalData = async imageFile => {\n  // Try Spider Farmer format first\n  const spiderFarmerResult = await parseSpiderFarmerScreenshot(imageFile);\n  if (spiderFarmerResult.success) {\n    return {\n      ...spiderFarmerResult,\n      source: 'Spider Farmer App'\n    };\n  }\n\n  // Could add other app parsers here in the future\n  return {\n    ...spiderFarmerResult,\n    source: 'Unknown',\n    message: 'Could not parse environmental data from image. Please ensure the image shows clear readings from a supported app.'\n  };\n};","map":{"version":3,"names":["Tesseract","parseSpiderFarmerScreenshot","imageFile","data","text","recognize","logger","m","console","log","tessedit_char_whitelist","result","temperature","humidity","ph","co2","vpd","ppfd","success","parsedValues","lines","split","map","line","trim","filter","length","numberPattern","allNumbers","match","exec","number","parseFloat","index","contextBefore","substring","Math","max","toLowerCase","contextAfter","min","push","value","fullContext","num","context","includes","sortedNumbers","sort","a","b","n","tempCandidate","find","humidCandidate","vpdCandidate","co2Match","val","numIndex","indexOf","surrounding","ppfdMatch","phMatch","Object","values","some","error","message","preprocessImageForOCR","canvas","imageData","getImageData","width","height","i","gray","contrast","putImageData","toDataURL","parseEnvironmentalData","spiderFarmerResult","source"],"sources":["/home/dmans218/projects/Growlogger/frontend/src/utils/ocrParser.js"],"sourcesContent":["import Tesseract from 'tesseract.js';\n\n// Parse environmental data from Spider Farmer app screenshot\nexport const parseSpiderFarmerScreenshot = async (imageFile) => {\n  try {\n    const { data: { text } } = await Tesseract.recognize(imageFile, 'eng', {\n      logger: m => console.log(m),\n      tessedit_char_whitelist: '0123456789.°C%kPa ppm μmol/s-+:VPDCOTemperatureHumidityAir ',\n    });\n\n    console.log('OCR Raw Text:', text);\n\n    // Initialize result object\n    const result = {\n      temperature: null,\n      humidity: null,\n      ph: null,\n      co2: null,\n      vpd: null,\n      ppfd: null,\n      success: false,\n      parsedValues: {}\n    };\n\n    // Clean text for better analysis\n    const lines = text.split('\\n').map(line => line.trim()).filter(line => line.length > 0);\n    console.log('Text lines:', lines);\n\n    // Extract all numbers with context for smarter parsing\n    const numberPattern = /(\\d+\\.?\\d*)/g;\n    const allNumbers = [];\n    let match;\n    while ((match = numberPattern.exec(text)) !== null) {\n      const number = parseFloat(match[1]);\n      const index = match.index;\n      const contextBefore = text.substring(Math.max(0, index - 20), index).toLowerCase();\n      const contextAfter = text.substring(index, Math.min(text.length, index + 20)).toLowerCase();\n      allNumbers.push({\n        value: number,\n        text: match[1],\n        index: index,\n        contextBefore: contextBefore,\n        contextAfter: contextAfter,\n        fullContext: contextBefore + match[1] + contextAfter\n      });\n    }\n    \n    console.log('Numbers with context:', allNumbers);\n\n    // Parse Temperature - look for temperature in proper range with °C\n    for (const num of allNumbers) {\n      if (!result.temperature && num.value >= 15 && num.value <= 40) {\n        const context = num.fullContext;\n        // Check if it's near temperature indicators and has degree symbol\n        if ((context.includes('temp') || context.includes('air')) && \n            (context.includes('°') || context.includes('º')) &&\n            !context.includes('vpd') && !context.includes('%')) {\n          result.temperature = num.value;\n          result.parsedValues.temperature = `${num.value}°C`;\n          console.log('Found temperature:', num.value, 'Context:', context);\n          break;\n        }\n      }\n    }\n\n    // Parse Humidity - look for percentage values in humidity range\n    for (const num of allNumbers) {\n      if (!result.humidity && num.value >= 20 && num.value <= 100) {\n        const context = num.fullContext;\n        // Check if it's clearly marked as percentage or near humidity keywords\n        if (context.includes('%') || \n            (context.includes('humid') && !context.includes('°') && !context.includes('vpd'))) {\n          result.humidity = num.value;\n          result.parsedValues.humidity = `${num.value}%`;\n          console.log('Found humidity:', num.value, 'Context:', context);\n          break;\n        }\n      }\n    }\n\n    // Parse VPD - look for small decimal values with kPa context  \n    for (const num of allNumbers) {\n      if (!result.vpd && num.value >= 0.1 && num.value <= 5.0) {\n        const context = num.fullContext;\n        // VPD should be small decimal near \"VPD\" text or \"kPa\"\n        if (context.includes('vpd') || \n            (context.includes('kpa') && num.value < 10) ||\n            (num.value < 2.0 && context.includes('kpa'))) {\n          result.vpd = num.value;\n          result.parsedValues.vpd = `${num.value} kPa`;\n          console.log('Found VPD:', num.value, 'Context:', context);\n          break;\n        }\n      }\n    }\n\n    // Fallback parsing if direct context matching fails\n    if (!result.temperature || !result.humidity || !result.vpd) {\n      console.log('Using fallback parsing...');\n      \n      // Sort numbers by value to help identify them\n      const sortedNumbers = [...allNumbers].sort((a, b) => a.value - b.value);\n      console.log('Sorted numbers:', sortedNumbers.map(n => n.value));\n      \n      // If we don't have temperature, look for number around 20-25 (room temp)\n      if (!result.temperature) {\n        const tempCandidate = sortedNumbers.find(n => n.value >= 18 && n.value <= 30);\n        if (tempCandidate && !tempCandidate.fullContext.includes('%')) {\n          result.temperature = tempCandidate.value;\n          result.parsedValues.temperature = `${tempCandidate.value}°C`;\n          console.log('Fallback temperature:', tempCandidate.value);\n        }\n      }\n      \n      // If we don't have humidity, look for larger numbers with %\n      if (!result.humidity) {\n        const humidCandidate = sortedNumbers.find(n => \n          n.value >= 40 && n.value <= 95 && \n          (n.fullContext.includes('%') || n.value > 50)\n        );\n        if (humidCandidate) {\n          result.humidity = humidCandidate.value;\n          result.parsedValues.humidity = `${humidCandidate.value}%`;\n          console.log('Fallback humidity:', humidCandidate.value);\n        }\n      }\n      \n      // If we don't have VPD, look for small decimals\n      if (!result.vpd) {\n        const vpdCandidate = sortedNumbers.find(n => \n          n.value >= 0.1 && n.value <= 2.0 && \n          n.text.includes('.')\n        );\n        if (vpdCandidate) {\n          result.vpd = vpdCandidate.value;\n          result.parsedValues.vpd = `${vpdCandidate.value} kPa`;\n          console.log('Fallback VPD:', vpdCandidate.value);\n        }\n      }\n    }\n\n        // Parse CO2 (ppm pattern)\n    let co2Match = text.match(/co\\s*[₂2]?\\s*[:-]?\\s*(\\d+)/i) || \n                     text.match(/(\\d+)\\s*ppm/i);\n    \n    // Look for numbers in CO2 range\n    if (!co2Match && allNumbers.length > 0) {\n      for (const num of allNumbers) {\n        const val = parseFloat(num);\n        if (val >= 300 && val <= 2000) { // Typical CO2 range\n          const numIndex = text.indexOf(num);\n          const surrounding = text.substring(Math.max(0, numIndex - 15), numIndex + 15).toLowerCase();\n          if (surrounding.includes('co2') || surrounding.includes('ppm')) {\n            co2Match = [null, num];\n            break;\n          }\n        }\n      }\n    }\n    \n    if (co2Match) {\n      result.co2 = parseFloat(co2Match[1]);\n      result.parsedValues.co2 = `${co2Match[1]} ppm`;\n    }\n\n        // Parse PPFD (μmol pattern)\n    let ppfdMatch = text.match(/ppfd\\s*[:-]?\\s*(\\d+)/i) ||\n                      text.match(/(\\d+)\\s*[μu]mol/i);\n    \n    // Look for numbers in PPFD range\n    if (!ppfdMatch && allNumbers.length > 0) {\n      for (const num of allNumbers) {\n        const val = parseFloat(num);\n        if (val >= 100 && val <= 2000) { // Typical PPFD range\n          const numIndex = text.indexOf(num);\n          const surrounding = text.substring(Math.max(0, numIndex - 15), numIndex + 15).toLowerCase();\n          if (surrounding.includes('ppfd') || surrounding.includes('μmol') || surrounding.includes('umol')) {\n            ppfdMatch = [null, num];\n            break;\n          }\n        }\n      }\n    }\n    \n    if (ppfdMatch) {\n      result.ppfd = parseFloat(ppfdMatch[1]);\n      result.parsedValues.ppfd = `${ppfdMatch[1]} μmol/m²/s`;\n    }\n\n    // Parse pH\n    let phMatch = text.match(/ph\\s*[:\\-]?\\s*(\\d+\\.?\\d*)/i);\n    if (!phMatch && allNumbers.length > 0) {\n      for (const num of allNumbers) {\n        const val = parseFloat(num);\n        if (val >= 4.0 && val <= 9.0) { // Typical pH range\n          const numIndex = text.indexOf(num);\n          const surrounding = text.substring(Math.max(0, numIndex - 10), numIndex + 10).toLowerCase();\n          if (surrounding.includes('ph')) {\n            phMatch = [null, num];\n            break;\n          }\n        }\n      }\n    }\n    \n    if (phMatch) {\n      result.ph = parseFloat(phMatch[1]);\n      result.parsedValues.ph = phMatch[1];\n    }\n\n    // Check if we found at least one value\n    result.success = Object.values(result).some(val => val !== null && typeof val === 'number');\n\n    console.log('Parsed result:', result);\n    return result;\n  } catch (error) {\n    console.error('OCR Error:', error);\n    return {\n      temperature: null,\n      humidity: null,\n      ph: null,\n      co2: null,\n      vpd: null,\n      ppfd: null,\n      success: false,\n      error: error.message,\n      parsedValues: {}\n    };\n  }\n};\n\n// Helper function to preprocess image for better OCR\nexport const preprocessImageForOCR = (canvas, context) => {\n  const imageData = context.getImageData(0, 0, canvas.width, canvas.height);\n  const data = imageData.data;\n\n  // Convert to grayscale and increase contrast\n  for (let i = 0; i < data.length; i += 4) {\n    const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;\n    \n    // Increase contrast (simple threshold)\n    const contrast = gray > 128 ? 255 : 0;\n    \n    data[i] = contrast;     // Red\n    data[i + 1] = contrast; // Green\n    data[i + 2] = contrast; // Blue\n  }\n\n  context.putImageData(imageData, 0, 0);\n  return canvas.toDataURL();\n};\n\n// Parse different app layouts/formats\nexport const parseEnvironmentalData = async (imageFile) => {\n  // Try Spider Farmer format first\n  const spiderFarmerResult = await parseSpiderFarmerScreenshot(imageFile);\n  \n  if (spiderFarmerResult.success) {\n    return {\n      ...spiderFarmerResult,\n      source: 'Spider Farmer App'\n    };\n  }\n\n  // Could add other app parsers here in the future\n  return {\n    ...spiderFarmerResult,\n    source: 'Unknown',\n    message: 'Could not parse environmental data from image. Please ensure the image shows clear readings from a supported app.'\n  };\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}